import{u as I,a as k,r as n,j as e,s as b,b as g,c as W,d as L,e as y,f as p,g as N,h as S,i as C,k as E,q as R,l as z,w as B,m as F}from"./index-wKudUIDS.js";const H=()=>{const i=I(),x=k(),[o,j]=n.useState(!0),[s,q]=n.useState(!0),[t,w]=n.useState(""),[d,P]=n.useState(""),[u,D]=n.useState(""),[f,U]=n.useState(""),[v,l]=n.useState(""),A=async a=>{if(a.preventDefault(),l(""),!s&&u!==f){l("Passwords do not match!");return}if(!s&&!t.trim()){l("User name is required for registration!");return}try{if(o){const r=s?await b(g,d,u):await W(g,d,u);s||await L(y(p,"users",r.user.uid),{username:t.trim(),email:r.user.email});let c=t;if(s){const h=await N(y(p,"users",r.user.uid));h.exists()&&(c=h.data().username||"")}i(S(c)),i(C(r.user.email||"")),i(E(!0)),x("/Weather")}else{const r=R(z(p,"users"),B("username","==",t)),c=await F(r);if(c.empty)throw new Error("Username not found");const m=c.docs[0].data().email;await b(g,m,u),i(S(t)),i(C(m)),i(E(!0)),x("/Weather")}}catch(r){r instanceof Error?l(r.message):l("An error occurred. Please try again.")}};return e.jsxs("form",{onSubmit:A,children:[e.jsx("h2",{children:s?"Sign In":"Create Account"}),e.jsxs("label",{children:[e.jsx("input",{type:"radio",checked:o,onChange:()=>j(!0)}),"Use email"]}),e.jsxs("label",{children:[e.jsx("input",{type:"radio",checked:!o,onChange:()=>j(!1)}),"Use user name"]}),o&&e.jsx("div",{children:e.jsxs("label",{children:["Email:",e.jsx("input",{type:"email",value:d,onChange:a=>P(a.target.value),required:!0,autoComplete:"username"})]})}),!o&&e.jsx("div",{children:e.jsxs("label",{children:["User name:",e.jsx("input",{type:"userName",value:t,onChange:a=>w(a.target.value),required:!0})]})}),!s&&e.jsx("div",{children:e.jsxs("label",{children:["Username (required):",e.jsx("input",{value:t,onChange:a=>w(a.target.value),required:!0})]})}),e.jsx("div",{children:e.jsxs("label",{children:["Password:",e.jsx("input",{type:"password",value:u,onChange:a=>D(a.target.value),required:!0,autoComplete:"current-password"})]})}),!s&&e.jsx("div",{children:e.jsxs("label",{children:["Confirm Password:",e.jsx("input",{type:"password",value:f,onChange:a=>U(a.target.value),required:!0,autoComplete:"new-password"})]})}),v&&e.jsx("div",{style:{color:"red"},children:v}),e.jsx("br",{}),e.jsx("button",{className:"sign-in",type:"submit",children:s?"Sign In":"Register"}),e.jsx("div",{children:e.jsx("button",{type:"button",onClick:()=>q(!s),children:s?"Create an account":"Already have an account? Sign in"})})]})};export{H as SignIn,H as default};
